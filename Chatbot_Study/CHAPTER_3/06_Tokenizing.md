## 토크나이징

<br/>

- 자연어 처리 (Natural Language Processing. NLP) 기법 중 하나
  1. 어떤 문장을 의미가 있는 가장 작은 단어들로 나눔
  2. 나눠진 단어들을 이용해 의미 분석 
  3. 이때 가장 기본이 되는 단어들을 토큰 (token)이라고 함. 토큰의 기준은 달라질 수 있음
  4. 주어진 문장에서 토큰 단위로 정보를 나누는 작업을 토크나이징이라고 함
- 문장 형태의 데이터를 처리하기 위해 제일 처음 수행하는 기본 작업으로 텍스트 전처리 과정에서 사용 됨
- 이 책에서는 형태소(morpheme)를 토큰 단위로 사용 (더 이상 쪼개지지 않는 단어 크기)
  - 문장에서 형태소 뿐 아니라 어근, 접두사/접미사, 품사 등 다양한 언어적 속성의 구조를 파악 하기 위해 `형태소 분석기`를 사용 함
  - 각각의 형태소에 품사가 태깅되어 반환 됨

<br/>

#### 5언 9품사

|        | 품사   | 설명                                                         |
| ------ | ------ | ------------------------------------------------------------ |
| 체언   |        | 문장에서 주어나 목적어가 되는 낱말                           |
|        | 명사   | 주로 물건이나 사람, 동식물을 가리킬 때 쓰는 품사             |
|        | 대명사 | 사람이나 사물의 이름을 대신해서 쓰는 품사                    |
|        | 수사   | 숫자나 순서를 나타내는 품사                                  |
| 용언   |        | 문장 안에서 서술어 구실을 하는 낱말들                        |
|        | 동사   | 동작이나 작용을 나타내는 품사                                |
|        | 형용사 | 사물의 성질이나 상태를 나타내는 품사                         |
| 수식언 |        | 다른 품사를 수식하기 위해 존재하는 품사                      |
|        | 관형사 | 체언(명사, 대명사, 수사) 앞에서 체언을 수식하는 품사         |
|        | 부사   | 동사, 형용사, 동사구, 문장 전체를 수식하는 역할을 맡은 품사  |
| 관계언 |        | 문장 안의 다른 성분과 관련되는 관계를 나타내기 위해 붙는 낱말 |
|        | 조사   | 명사, 부사 따위에 붙어 문법 관계를 맺어주는 품사             |
| 독립언 |        | 문장에서 다른 단어에 얽매이지 않고 독립적으로 쓰이는 단어    |
|        | 감탄사 | 감탄이나 놀람, 느낌, 응답 등을 나타내는 품사                 |

[출처:나무위키](https://namu.wiki/w/%ED%95%9C%EA%B5%AD%EC%96%B4%EC%9D%98%205%EC%96%B8%209%ED%92%88%EC%82%AC)

<br/>

### KoNLPy

- 한국어 자연어 처리에 많이 사용하는 한국어 토크나이징 지원 파이썬 라이브러리
- 공식 사이트에 따르면 코엔엘파이라고 읽음
- 오픈소스 소프트웨어, GPL v3 라이선스(또는 그 이상)에 따라 사용 가능
- 내부 모듈에 사용하기 좋은 몇 가지 형태소 분석기를 통합해 라이브러리 형태로 제공
  - 각 형태소 분석기 함수의 인터페이스를 통일 시켜 각 형태소 분석기 모듈에서 지원하는 함수 사용법이 거의 동일 함

<br/>

### Kkma

- 서울대학교 IDS(Intelligent Data Systems) 연구실에서 자연어 처리를 위해 개발한 한국어 형태소 분석기
- `꼬꼬마`로 발음하며 GPS v2 라이선스를 따름
- 매우 느리지만 비교적 정확한 편
- 지원하는 품사 태그가 가장 많음
- 사용자 사전으로 추가한 복합 명사에 대해 불완전하게 동작함
- KoNLPy의 꼬꼬마 형태소 분석기를 사용하기 위해서는 konlpy.tag 패키지의 Kkma 모듈을 불러와야 함

```python
from konlpy.tag import Kkma
```

<br/>

#### 4가지 제공 함수

| 함수                      | 설명                                                         |
| ------------------------- | ------------------------------------------------------------ |
| morphs(phrase)            | 인자로 입력한 문장을 형태소 단위로 토크나이징 한다.<br />토크나이징 된 형태소들은 리스트 형태로 반환 |
| nouns(phrase)             | 인자로 입력한 문장에서 품사가 명사인 토큰만 추출             |
| pos(phrase, flatten=True) | POS tagger라 부르며 인자로 입력한 문장에서 형태소를 추출한 뒤 품사 태깅<br />추출된 형태소와 그 형태소의 품사가 튜플 형태로 묶여서 리스트로 반환 |
| sentences(phrase)         | 인자로 입력한 여러 문장을 분리해주는 역할<br />분리된 문장은 리스트 형태로 반환 |

<br/>

##### Kkma 형태소 분석의 품사 태그 정보

| 품사 | 설명                   |
| ---- | ---------------------- |
| NNG  | 일반 명사              |
| JKS  | 주격 조사              |
| JKM  | 부사격 조사            |
| VV   | 동사                   |
| EFN  | 평서형 종결 어미       |
| SF   | 마침표, 물음표, 느낌표 |

- 총 46개의 품사 태그 지원
- [참고 사이트](kkma.snu.ac.kr/documents/?doc=postag)

<br/>

### Komoran

- Korean Morphological ANalyzer의 약자, 코모란이라 발음
  -  Shineware에서 자바로 개발한 한국어 형태소 분석기
- Apache 라이선스 2.0을 따르는 오픈소스 소프트웨어
- 공백 포함 형태소 단위로도 분석 가능
- 꼬꼬마보다 빠르고 다양한 품사 태그 지원
- 자소가 분리된 문장이나 오탈자에 강함
- 사용자 사전 관리 용이
- 적당한 품질과 분석 속도
- KoNLPy의 코모란 형태소 분석기를 사용하기 위해서는 konlpy.tag 패키지의 komoran모듈을 불러와야 함

```python
from konlpy.tag import Komoran
```

<br/>

#### 3가지 제공 함수

| 함수                      | 설명                                                         |
| ------------------------- | ------------------------------------------------------------ |
| morphs(phrase)            | 인자로 입력한 문장을 형태소 단위로 토크나이징 한다.<br />토크나이징 된 형태소들은 리스트 형태로 반환 |
| nouns(phrase)             | 인자로 입력한 문장에서 품사가 명사인 토큰만 추출             |
| pos(phrase, flatten=True) | POS tagger라 부르며 인자로 입력한 문장에서 형태소를 추출한 뒤 품사 태깅<br />추출된 형태소와 그 형태소의 품사가 튜플 형태로 묶여서 리스트로 반환 |

<br/>

##### komoran 형태소 분석의 품사 태그 정보

| 품사 | 설명                   |
| ---- | ---------------------- |
| NNG  | 일반 명사              |
| JKS  | 주격 조사              |
| JKM  | 부사격 조사            |
| VV   | 동사                   |
| EF   | 종결 어미              |
| SF   | 마침표, 물음표, 느낌표 |

- 총 42개의 품사 태그 지원
- [참고 사이트](docs.komoran.kr/firststep/postypes.html)

<br/>

### Okt

- Open-source Korean Text Processor의 약어
  - 트위터에서 개발한 Twitter  한국어 처리기에서 파생된 오픈 소스
- 아파치 2.0 라이선스를 따름
- 빅데이터에서 간단한 한국어 처리를 통해 색인어를 추출하는 목표를 갖기 때문에 완전한 수준의 형태소 분석을 지향하지 않음
  - 때문에 공식적으로 한국어 처리기라 표현
- 띄어쓰기가 어느 정도 되어 있는 문장을 빠르게 분석 할 때 많이 사용
- 매우 빠른 분석 속동와 정규화 기능 지원이 장점
- 사용자 사전 관리가 어렵고 용언 분석에 일관성이 부족함.
- KoNLPy의 Okt형태소 분석기를 사용하기 위해서는 konlpy.tag 패키지의 Okt모듈을 불러와야 함

```python
from konlpy.tag import Okt
```

<br/>

#### Okt 모듈의 함수

| 함수                      | 설명                                                         |
| ------------------------- | ------------------------------------------------------------ |
| morphs(phrase)            | 인자로 입력한 문장을 형태소 단위로 토크나이징 한다.<br />토크나이징 된 형태소들은 리스트 형태로 반환 |
| nouns(phrase)             | 인자로 입력한 문장에서 품사가 명사인 토큰만 추출             |
| pos(phrase, flatten=True) | POS tagger라 부르며 인자로 입력한 문장에서 형태소를 추출한 뒤 품사 태깅<br />추출된 형태소와 그 형태소의 품사가 튜플 형태로 묶여서 리스트로 반환 |
| normalize(phrase)         | 입력한 문장을 정규화 시킵니다.<br />ex) 정규화 전 : 재밌엌ㅋㅋ -> 정규화 후 : 재밌어ㅋㅋ |
| phrases(phrase)           | 입력한 문장에서 어구를 추출합니다.<br />ex) 입력 : 오늘 날씨가 좋아요. -> 출력 : ['오늘', '오늘 날씨', '날씨'] |

<br/>

##### Okt 형태소 분석의 품사 태그 정보

| 품사        | 설명   |
| ----------- | ------ |
| NOUN        | 명사   |
| Verb        | 동사   |
| Adjective   | 형용사 |
| Josa        | 조사   |
| Punctuation | 구두점 |

- [참고 사이트](https://openkoreantext.org)

<br/>

### 사용자 사전 구축

- 챗봇 사용자들은 보통 인터넷 구어체를 많이 사용하기에 새로운 형태의 단어나 문장이 입력되는 경우가 많음
  - 기존의 많은 단어로 학습 되어 개발된 형태소 분석기 모델의 성능 저하의 원인이 됨
  - 이를 해결하기 위해 대부분의 형태소 분석기들은 사용자 사전을 추가할 수 있도록 구성 함
- 데이터 기반으로 새로운 단어를 추출해 적용하는 기술이 개발 되고 있지만 책에서 다루지는 않음
- 코모란이 다른 형태소 분석기에 비해 사용자 사전 관리 방법이 편리하고 분석 성능과 속도가 괜찮은 편
  - 앞으로 책에서는 코모란 기준으로 챗봇을 만들 예정

<br/>

- 문장 내에 사전에 포함 된 단어가 나오면 코모란은 우선적으로 사전에 정의된 품사 태그를 붙인다
  - 주로 사람 이름, 지명, 인터넷 용어, 특수 용어 등 고유 명사를 인식하는 데 활용
- 단어와 품사를 `tab`으로 구분하여 입력하며, 단어 사이의 띄어 쓰기 허용 됨
  - 품사 정보를 생략하는 경우 기본적으로 고유명서(NNP)로 인식하며 라인에 #을 사용하면 주석 처리 됨

```python
# [단어] `tab` [품사]
엔엘피	NNG
나는 내일, 어제의 너와 만난다	NNG
시샵
```

- 해당 내용을 .tsv 확장자로 저장 함
  - 파일 포맷을 지키지 않으면 인식 안 됨

```python
from konlpy.tag import Komoran

komoran = Komoran(userdic='./user_dic.tsv')
```

- 코모란 생성자의 인자로 사용자 정의 파일 경로를 사용

<br/>

